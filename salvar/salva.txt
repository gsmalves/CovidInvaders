import pygame
import random
import sys

# Inicialização do Pygame
pygame.init()

# Definição das dimensões da tela
WIDTH = 800
HEIGHT = 600

# Definição das cores
WHITE = (255, 255, 255)
RED = (255, 0, 0)

# Criação da tela
screen = pygame.display.set_mode((WIDTH, HEIGHT))
pygame.display.set_caption("Covid Invaders")



# Carregando imagens
player_img = pygame.image.load("assets/player.png")
virus_img = pygame.image.load("assets/enemy1.png")
projectile_img_g = pygame.image.load("assets/tiro_vermelho.png")
# flipped_image = pygame.transform.flip(projectile_img_g, False, True)
vaccine_img = pygame.transform.scale(projectile_img_g , (8, 16 ))



# Obtém o retângulo da imagem do jogador
player_rect = player_img.get_rect()

# Posicionamento inicial do jogador
player_rect.x = WIDTH // 2 - player_rect.width // 2
player_rect.y = HEIGHT - player_rect.height - 10

# Velocidade do jogador
player_speed = 5

# Lista de vírus
virus_list = []

# Criação dos vírus
for _ in range(10):
    virus_rect = virus_img.get_rect()
    virus_rect.x = random.randint(0, WIDTH - virus_rect.width)
    virus_rect.y = random.randint(-HEIGHT, -virus_rect.height)
    virus_speed = random.randint(1, 5)
    virus_list.append((virus_rect, virus_speed))

# Velocidade de movimento dos vírus
virus_speed_x = 0
virus_speed_y = 2

# Variável de pontuação inicial
score = 0

# Fonte para exibir a pontuação
font = pygame.font.Font(None, 36)

# Função para exibir a pontuação na tela
def display_score():
    score_text = font.render("Score: " + str(score), True, WHITE)
    screen.blit(score_text, (10, 10))

# Loop principal do jogo
running = True
while running:
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False

    keys = pygame.key.get_pressed()
    if keys[pygame.K_LEFT]:
        player_rect.x -= player_speed
    if keys[pygame.K_RIGHT]:
        player_rect.x += player_speed

    # Movimenta os vírus
    for virus_rect, virus_speed in virus_list:
        virus_rect.x += virus_speed_x
        virus_rect.y += virus_speed_y

        # Verifica colisão entre jogador e vírus
        if player_rect.colliderect(virus_rect):
            running = False

        # Verifica colisão entre vacina e vírus
        if vaccine_rect.colliderect(virus_rect):
            score += 10
            virus_list.remove((virus_rect, virus_speed))

        # Verifica se os vírus atingiram a parte inferior da tela
        if virus_rect.y >= HEIGHT:
            virus_rect.x = random.randint(0, WIDTH - virus_rect.width)
            virus_rect.y = random.randint(-HEIGHT, -virus_rect.height)
            virus_speed = random.randint(1, 5)
            virus_list.append((virus_rect, virus_speed))

    # Atualiza a tela
    screen.fill(RED)  # Preenche a tela com a cor vermelha
    screen.blit(player_img, player_rect)  # Desenha o jogador na tela

    # Desenha os vírus na tela
    for virus_rect, _ in virus_list:
        screen.blit(virus_img, virus_rect)

    # Exibe a pontuação na tela
    display_score()

    pygame.display.flip()  # Atualiza a tela

# Encerra o jogo
pygame.quit()
sys.exit()
